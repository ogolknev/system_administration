# Конспект 1
## Системное и сетевое администрирование. Практическое руководство. Второе издание
### Глава 3. Рабочие станции

При правильном обслуживании рабочих станций у новых сотрудников с первого дня на работе будет все необходимое, включая основную инфраструктуру.

Обслуживание операционных систем на рабочих станциях сводится к выполнению трех основных задач: первоначальная установка системного программного обеспечения и приложений, обновление системного программного обеспечения и приложений, настройка сетевых параметров. Мы называем эти задачи «большой тройкой». Если вам не удастся должным образом решить эти три задачи, остальная ваша работа значительно осложнится, а автоматизация этих задач значительно изменит ситуацию к лучшему.

**Рабочая станция может находиться в пяти состояниях:**
- **Новое состояние** относится к совершенно новой машине.
- **Чистое состояние** относится к машине с установленной, но еще не настроенной ОС.
- **Сконфигурированное состояние** означает, что система настроена и функцио­нирует должным образом.
- **Неизвестное состояние** относится к компьютеру, который был неправильно сконфигурирован или конфигурация которого устарела.
- **Отключенное состояние** относится к машине, которая была списана и отключена.
  
Какую информацию мы можем получить из этой схемы?

Во-первых, необходимо признать, что существуют различные состояния и переходы. Не стоит удивляться каждому сбою. Необходимо разработать план исправления.

Во-вторых, видно, что, несмотря на существование нескольких видов состояний, компьютер можно использовать только в сконфигурированном состоянии. Необходимо до максимума увеличить время, проводимое в этом состоянии.Чтобы продлить время пребывания компьютера в сконфигурированном состоянии, необходимо сделать так, чтобы деградация ОС протекала как можно медленнее. Архитектурное решение, принятое системным администратором, может усилить или ослабить целостность операционной системы. Системные администраторы должны найти необходимый баланс между предоставлением пользователям полного доступа и ограничением их прав. Этот баланс влияет на скорость разрушения операционной системы.

И наконец, эта модель показывает, что машины в конце концов списываются. И этому не стоит удивляться: машины не могут работать вечно.

#### 3.1 Основы

С обслуживанием операционных систем рабочей станции связаны три критически важных аспекта:

1. Первоначальная установка системного ПО и приложений.
2. Обновление системного ПО и приложений.
3. Настройка сетевых параметров.

Если вы хотите, чтобы управление вашей сетью производилось с минимальными затратами, эти три задачи необходимо автоматизировать для любой платформы, которая используется в вашей сети.

«Привилегированные объекты» – платформы, которые должны получать полноценную поддержку. Платформа может получить статус «привилегированного объекта» по целому ряду причин. По запросу пользователей или по инициативе системных администраторов.

Автоматизация решает огромное количество проблем, но не все из них являются техническими. Во-первых, автоматизация экономит деньги. Разумеется, одним из основных преимуществ является время, выигранное за счет замены ручных процессов автоматическими. Кроме того, автоматизация устраняет два вида скрытых затрат. Первый относится к ошибкам: при ручном выполнении процессов существует вероятность ошибок. Второй тип скрытых затрат относится к неоднородности. Если вы вручную устанавливаете операционную систему, вы никогда не добьетесь той же конфигурации на другой машине. Никогда.

Самый важный аспект автоматизации заключается в том, что установка должна быть полностью автоматизирована. Процедуру, требующую возвращения человека посреди установки для ответа на тот или иной вопрос, нельзя назвать полностью автоматизированной, и она теряет эффективность.

Частичная автоматизация лучше, чем ее полное отсутствие. До тех пор пока система установки не будет работать идеально, необходимо обеспечить какие-то временные средства для некоторых этапов. Автоматизация оставшегося 1% может занять больше времени, чем автоматизация первых 99%.

К сожалению, с течением времени обнаруживаются новые ошибки и новые бреши в системе безопасности, и все их необходимо исправлять. Кроме того, появляются прекрасные новые приложения, которые необходимо устанавливать. Все эти задачи относятся к области **обновления программного обеспечения**. Как и в случае с установкой, процесс обновления можно автоматизировать, сэкономив время и силы.

Системы обновления ПО должны быть достаточно универсальными, чтобы они позволяли устанавливать новые приложения и обновлять уже имеющиеся, а также устанавливать патчи ОС.

Вы можете снизить риск ошибок обновления, применив метод «**одна, несколько, много**».

- *Одна*. Прежде всего установите патч на одну машину. Лучше всего на свою собственную – тогда у вас будет дополнительный стимул все сделать правильно. Если при обновлении возникнут ошибки, вносите в процесс изменения до тех пор, пока он не будет работать на одной машине без ошибок.
- *Несколько*. Далее попробуйте установить патч на несколько других машин. Если это возможно, стоит протестировать автоматизированный процесс обновления на рабочих станциях остальных системных администраторов, прежде чем задействовать машины пользователей. Системные администраторы проявляют чуть больше понимания. Затем протестируйте систему на нескольких машинах дружелюбно настроенных к вам пользователей (не системных администраторов).
- *Много*. Протестировав свою систему и убедившись, что она не уничтожит ничей жесткий диск, начинайте постепенно переходить ко все большим и большим группам пользователей, нетерпимых к риску.

Третий компонент, необходимый для сетей, объединяющих большое количество рабочих станций, – это способ автоматизации обновления сетевых параметров.  Эта информация может значительно различаться в отдельных подсетях или даже в отдельных узлах сети. А следовательно, такое обновление должно производиться иначе, чем, скажем, установка приложений, когда одно и то же приложение устанавливается на всех узлах сети с одинаковой конфигурацией. Поэтому система автоматизации обновления сетевых параметров обычно создается отдельно от остальных систем. Наиболее распространенная система автоматизации этого процесса – DHCP.

Системы DHCP должны иметь систему шаблонов. Преимущество шаблонов в том, что при внесении изменений на множестве узлов вам нужно будет просто изменить шаблон, что значительно лучше, чем прокручивать длинный список узлов сети, пытаясь найти те, которые требуется изменить. Еще одно преимущество в том, что значительно уменьшается вероятность появления ошибки в синтаксисе, если конфигурационный файл генерируется программой.

Как правило, DHCP назначает отдельный IP-адрес каждому узлу сети. Функция динамической аренды адресов позволяет вам указать диапазон IP-адресов, которые можно присваивать узлам сети. Эти узлы смогут при каждом подключении к сети получать новый IP-адрес. Преимущество в том, то облегчается работа администраторов и повышается удобство для пользователей. Зачастую лучше закрепить конкретный IP-адрес за конкретным узлом сети. Это особенно важно для серверов, чьи IP-адреса прописываются в конфигурационных файлах других узлов, таких как DNS-серверы и межсетевые экраны. Динамическое распределение следует использовать в случаях, когда много узлов конкурируют за малое количество IP-адресов.

Старайтесь не использовать динамический DNS-сервер с DHCP. Эта впечатляющее на первый взгляд свойство излишне усложняет 
систему и создает ненужный риск для безопасности.

Управление сроками аренды DHCP может помочь в распределении обновлений. DHCP клиентам задается определенный набор параметров, который будет использоваться в течение определенного периода времени. По истечении этого периода 
они должны обновить свою аренду. Изменения вносятся во время обновления.

#### 3.2. Тонкости

Существуют автоматизированные процессы, но помимо этого есть и автоматизация процесса. Если мы абсолютно уверены в процессе, мы избавлены от необходимости беспокоиться об ошибках. И поэтому мы начинаем искать новые способы применения этого же процесса.

Если пользователи будут иметь дело со стандартной конфигурацией, вам необходимо вовлечь их в процесс составления спецификаций и разработки1. В идеале пользователи должны принимать участие в процессе разработки с самого начала.

Наличие нескольких стандартных конфигураций может быть прекрасно или ужасно, и именно системный администратор определяет, какой эпитет лучше применим в его случае. Чем больше стандартных конфигураций используется в корпоративной сети, тем труднее все их обслуживать. Однако, если потратить время и создать единую обобщенную систему, способную производить множественные конфигурации и поддаваться масштабированию, вы придете к настоящему успеху.

#### 3.3. Заключение

Мы рассмотрели процессы, связанные с обслуживанием операционных систем на настольных компьютерах. Настольные компьютеры, в отличие 
от серверов, как правило, развертываются в больших количествах, и все они обладают практически одной и той же конфигурацией. У каждого компьютера есть свой жизненный цикл, который начинается с установки ОС и заканчивается в тот момент, когда машину выключают в самый последний раз. В этот период программное обеспечение компьютера постепенно приходит в негодность в результате энтропии, обновляется и заново переустанавливается в начале нового цикла. В идеале все узлы сети, относящиеся к определенной платформе, в начале своего жизненного цикла должны иметь одну и ту же конфигурацию. Обновляться они должны параллельно. Некоторые стадии жизненного цикла важнее для пользователей, чем другие. Мы стремимся увеличить продолжительность более важных стадий и сократить продолжительность менее значительных.

Основу всего, чему посвящена данная глава, составляют три процесса:

1. Первичная установка ОС должна быть автоматизирована.
2. Обновление программного обеспечения должно быть автоматизировано.
3. Конфигурация сети должна администрироваться централизованно с помощью такой системы, как DHCP.

Эти три задачи имеют критическое значение для экономного управления. Грамотное их выполнение позволит всем последующим процессам проходить более гладко.

### Глава 4. Серверы

Эта глава посвящена серверам. В отличие от рабочих станций, предназначенных для одного пользователя, от сервера зависит множество пользователей. Следовательно, главным приоритетом для них становится надежность и есперебойная работа.

#### 4.1. Основы

Оборудование, продаваемое как сервер, качественно отличается от оборудования, приобретаемого для индивидуальной рабочей станции. У серверного оборудования другие возможности, а при его разработке учитывается другая экономическая модель. При установке и поддержке серверов используются особые процедуры.

Системы, продаваемые как серверы, отличаются от систем, предназначенных для использования в качестве клиентов или настольных рабочих станций. Часто предпринимаются попытки сэкономить за счет покупки настольного компьютера и установки на него серверного программного обеспечения. Такое решение может помочь на короткий срок, но это не лучший выбор для долгосрочных или крупных проектов, которые должны быть надежнее карточного домика.

Очень важно выбирать поставщиков, продукция которых известна своей надежностью. Некоторые поставщики экономят за счет использования компонентов потребительского класса, другие используют компоненты, которые соответствуют требованиям военного стандарта MIL-SPEC1.

При покупке сервера продумайте, как будет происходить ремонт. Все машины рано или поздно ломаются1. Поставщики все чаще предлагают самые разные дополнительные контракты на обслуживание. Например, в одной из форм контракта на обслуживание предоставляется выбор срока бслуживания заявки в течение 4 ч, в течение 12 ч или на следующий день. Среди других вариантов – предоставление клиенту возможности приобрести комплект запасных компонентов и пополнять его по мере необходимости.

На серверах хранятся критически важные данные и уникальные конфигурации, которые должны быть защищены. 

Серверы должны устанавливаться в условиях с надежными энергоснабжением, противопожарной защитой, сетью, охлаждением и физической безопасностью.

Серверы необязательно должны работать под управлением тех же ОС, что и их клиенты.

Для серверов необходима возможность удаленного обслуживания. Переключатель КВМ – устройство, позволяющее нескольким машинам использовать одну клавиатуру, видеоэкран и мышь (КВМ). IP-КВМ – КВМ, в которых нет ни клавиатуры, ни монитора, ни мыши. Достаточно просто подключиться к консольному серверу КВМ по сети с программного клиента на другой машине. Это можно сделать даже с ноутбука в кафе, если ноутбук подключен через VPN к вашей сети! Предшественник переключателя КВМ – последовательные консольные концентраторы, был предназначен для устройств с последовательным портом. Изначально у серверов не было видеокарт, но имелись последовательные порты, через которые можно было подключиться к терминалу. При использовании удаленной консоли придется продумать вопросы безопасности. Часто стратегии безопасности узла базируются на размещении консоли за запертыми дверями. Удаленный доступ разрушает эти стратегии. Следовательно, для консольных систем требуются продуманные системы аутентификации и конфиденциальности. Например, вы можете разрешить доступ к консольной системе только через шифрованный канал, такой как SSH, и внедрить аутентификацию на основе системы одноразовых паролей, например считывателей отпечатков пальцев.

Загрузочный диск, или диск с операционной системой, как правило, труднее всего заменить в случае его повреждения. Поэтому необходимо соблюдать особые меры безопасности, чтобы ускорить процесс восстановления. Для загрузочного диска каждого сервера необходимо создать зеркальный диск. Это означает, что установлено два диска и при любом обновлении основного диска тут же обновляется и второй. Если один из дисков откажет, система автоматически переключится на работоспособный диск. Большинство операционных систем позволяют сделать это программно, а многие контроллеры жестких дисков делают это на аппаратном уровне. Этот метод называется RAID 1.

#### 4.2. Тонкости

Одноцелевое устройство – устройство, созданное для выполнения одной конкретной задачи. Тостеры делают тосты. Миксеры смешивают. Те же действия можно выполнять и с помощью универсальных устройств, но есть определенные преимущества при использовании устройств, предназначенных для качественного выполнения одной конкретной задачи.

По предрасположенности к сбоям среди всех системных компонентов на втором месте после жестких дисков находятся блоки питания. Поэтому в идеале серверы должны быть обеспечены резервными блоками питания.

Избыточность n + 1 относится к системам, которые спроектированы таким образом, что система продолжает функционировать 
даже после сбоя одного из компонентов. Примером такой системы являются RAID-массивы, которые продолжают полноценно функционировать даже после выхода из строя одного из дисков, или коммутатор Ethernet с дополнительной многовходовой системой коммутации, который позволяет передавать трафик даже после сбоя одного из сегментов системы коммутации.

Напротив, при полной избыточности два полных набора оборудования объединены в отказоустойчивую конфигурацию. Первая система обеспечивает исполнение службы, а вторая бездействует в полной готовности взять на себя работу при сбое первой системы. Переключение на резервные мощности может осуществляться вручную (кто-то замечает сбой в первой системе и активирует 
вторую) или автоматически (вторая система отслеживает работу первой системы и сама активируется при ее отказе).

Другие системы с полной избыточностью используют распределение нагрузки. Обе системы полноценно функционируют и распределяют между собой рабочую нагрузку. Каждый сервер обладает достаточной мощностью, чтобы взять на себя всю нагрузку. Если в работе одной из систем возникает сбой, вторая система берет всю нагрузку на себя. Системы можно настроить таким образом, чтобы они отслеживали надежность работы друг друга. Либо можно использовать внешний источник управления потоками и распределением запросов на обслуживание.

Если n равно или больше 2, n + 1 выгоднее, чем полная избыточность. Пользователи обычно предпочитают этот метод из-за его экономичности.

Резервные компоненты должны поддерживать «горячую» замену. «Горячая» замена подразумевает возможность отключить и заменить компонент во время работы системы.

#### 4.3. Заключение

Приобретая серверы, мы принимаем различные решения, так как от серверов зависит деятельность множества пользователей, в то время как клиентская рабочая станция предназначена только для одного пользователя. В отличие от рынка настольных компьютеров, на рынке серверного оборудования важнейшее значение имеют иные экономические факторы. Знание этих факторов помогает принимать более грамотные решения при покупке. Серверы, как и любое другое оборудование, иногда дают сбои, поэтому необходимо заключить контракт на обслуживание или составить план восстановления, а также предусмотреть возможность резервного копирования и восстановления данных. Серверы должны располагаться в специальных машинных залах, обеспечивающих условия для надежной работы. Пространство в машинном зале необходимо распределить до момента покупки, а не когда прибудет сервер. Кроме того, заранее необходимо спланировать электросеть, пропускную способность сети и систему охлаждения. 

Серверам необходима возможность удаленного администрирования. Аппаратные или программные системы позволяют удаленно выполнять консольный доступ. Это позволяет освободить дополнительное пространство в машинном зале, а также дает возможность системным администраторам осуществлять работу из своего кабинета или дома. Системные администраторы могут проводить требуемое обслуживание без необходимости находиться непосредственно рядом с сервером. 

Для повышения надежности серверы часто оснащаются дополнительными системами, предпочтительно в конфигурации n + 1. Наличие зеркалированного системного диска, резервных источников питания и других дополнительных компонентов повышает период работоспособного состояния системы. Возможность заменять неисправные компоненты во время работы системы уменьшает среднее время восстановления и перерывы в обслуживании. Хотя в прошлом подобная избыточность была роскошью, в современных условиях она зачастую является необходимостью. 